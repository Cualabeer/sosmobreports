<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SOS Mechanics | Medway Mobile Mechanic</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root { --primary: #7a00ff; --whatsapp: #25D366; --bg: #f6f7fb; --white: #ffffff; }
        * { box-sizing: border-box; }
        body { font-family: system-ui, -apple-system, sans-serif; background: var(--bg); margin: 0; padding: 0; color: #111; overflow-x: hidden; }
        .container { max-width: 900px; margin: auto; padding: 20px; }
        
        h1, h2 { text-align: center; margin-bottom: 5px; }
        .subtext { text-align: center; color: #555; margin-bottom: 25px; font-size: 14px; }

        /* Infinite-feeling horizontal scroll */
        .cards { 
            display: flex; 
            gap: 16px; 
            overflow-x: auto; 
            padding: 10px 5px 25px; 
            scroll-snap-type: x mandatory; 
            scrollbar-width: none; /* Hide scrollbar Firefox */
        }
        .cards::-webkit-scrollbar { display: none; } /* Hide scrollbar Chrome/Safari */

        .card {
            min-width: 240px; background: var(--white); border-radius: 18px; padding: 20px;
            scroll-snap-align: center; box-shadow: 0 4px 15px rgba(0,0,0,.06);
            border: 2px solid transparent; text-align: center; transition: 0.3s;
        }
        .card.selected { border-color: var(--primary); background: #f4eeff; transform: scale(1.02); }
        .price { font-size: 24px; font-weight: 800; color: var(--primary); margin: 8px 0; }
        .hours { font-size: 12px; color: #777; font-weight: 600; text-transform: uppercase; }
        
        form { background: var(--white); padding: 25px; border-radius: 20px; box-shadow: 0 4px 15px rgba(0,0,0,.05); }
        input, select, button { width: 100%; padding: 14px; margin-top: 12px; border-radius: 12px; border: 1px solid #ddd; font-size: 16px; }
        button { background: var(--primary); color: var(--white); border: none; font-weight: 700; cursor: pointer; transition: 0.2s; }
        button:active { transform: scale(0.98); }

        .gps-btn { background: #f0f0f0; color: #333; font-size: 14px; border: 1px dashed #bbb; }
        
        /* Modal */
        #choiceModal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,.7); z-index: 2000; align-items: center; justify-content: center; padding: 20px; }
        .choice-box { background: white; padding: 30px; width: 100%; max-width: 400px; border-radius: 24px; text-align: center; }
        .wa-btn { background: var(--whatsapp); margin-bottom: 12px; display: flex; align-items: center; justify-content: center; gap: 10px; }
    </style>
</head>
<body>

<div class="container">
    <h1>SOS Mechanics</h1>
    <p class="subtext">¬£50/hr Labour + ¬£50 Call-out. Medway & Surrounding.</p>

    <h2>1. Booking Slot</h2>
    <div style="display: flex; gap: 10px;">
        <input id="date" type="date">
        <select id="time"></select>
    </div>

    <h2 style="margin-top:25px;">2. Most Requested Services</h2>
    <p style="text-align: center; font-size: 12px; color: #999; margin-top: -10px;">(Swipe left/right to browse)</p>
    <div class="cards" id="services"></div>

    <form id="bookingForm" action="https://formspree.io/f/xaqdykza" method="POST">
        <input type="hidden" name="Service" id="serviceField">
        <input type="hidden" name="Price" id="priceField">
        
        <input required id="userName" name="Name" placeholder="Full Name">
        <input required id="userPhone" name="Phone" type="tel" placeholder="Mobile Number">
        <input required id="userVehicle" name="Vehicle" placeholder="Vehicle Make & Model">
        <input id="location" name="Location" placeholder="GPS Link (Optional)" readonly>
        <button type="button" class="gps-btn" onclick="getLocation()">üìç Tap to Share GPS Location</button>

        <button type="submit" style="margin-top: 25px;">Confirm Booking</button>
    </form>
</div>

<div id="choiceModal">
    <div class="choice-box">
        <h3>Booking Summary</h3>
        <p id="summaryText" style="font-weight: bold; color: var(--primary);"></p>
        <button class="wa-btn" onclick="handleBooking('whatsapp')"><i class="fab fa-whatsapp"></i> WhatsApp Booking (Fastest)</button>
        <button style="background: #333;" onclick="handleBooking('form')">Submit Email Request</button>
    </div>
</div>

<script>
const myNumber = "447405937104";
const HOURLY_RATE = 50;
const CALLOUT_FEE = 50;

// Top 15 Most Requested Services + Custom
const services = [
    { name: "Front Brake Pads", hrs: 1.5 },
    { name: "Rear Brake Pads", hrs: 1.5 },
    { name: "Full Service", hrs: 3.0 },
    { name: "Interim Service", hrs: 1.5 },
    { name: "Battery Replacement", hrs: 0.8 },
    { name: "Diagnostic Check", hrs: 1.0 },
    { name: "Alternator Change", hrs: 2.5 },
    { name: "Starter Motor", hrs: 2.0 },
    { name: "Water Pump", hrs: 3.5 },
    { name: "Brake Discs & Pads", hrs: 2.5 },
    { name: "Oil & Filter Change", hrs: 1.0 },
    { name: "Suspension Coil Spring", hrs: 1.5 },
    { name: "Drive Belt / Aux Belt", hrs: 1.0 },
    { name: "Spark Plug Refresh", hrs: 1.2 },
    { name: "Pre-MOT Inspection", hrs: 1.5 },
    { name: "Other Repair", hrs: 1.0 }
];

let selectedService = null;
const dateInput = document.getElementById("date");
const timeSelect = document.getElementById("time");

dateInput.min = new Date().toISOString().split("T")[0];
dateInput.value = dateInput.min;

for(let h=8; h<=20; h++) {
    let opt = document.createElement("option");
    opt.value = h; opt.text = h + ":00";
    timeSelect.appendChild(opt);
}

function calcTotal(hours) {
    let total = (hours * HOURLY_RATE) + CALLOUT_FEE;
    const d = new Date(dateInput.value);
    const h = parseInt(timeSelect.value);
    if(d.getDay() === 0 || d.getDay() === 6) total *= 1.2;
    else if(h < 9 || h >= 17) total *= 1.35;
    return total.toFixed(2);
}

function render() {
    const container = document.getElementById("services");
    container.innerHTML = "";
    services.forEach((s, index) => {
        const price = calcTotal(s.hrs);
        const card = document.createElement("div");
        card.className = `card ${selectedService?.name === s.name ? 'selected' : ''}`;
        card.id = `svc-${index}`;
        card.innerHTML = `
            <div class="hours">${s.hrs} HR Est.</div>
            <h3>${s.name}</h3>
            <div class="price">¬£${price}</div>
            <button type="button" onclick="select(${index})">
                ${selectedService?.name === s.name ? 'Selected' : 'Select'}
            </button>
        `;
        container.appendChild(card);
        if(selectedService?.name === s.name) {
            document.getElementById("serviceField").value = s.name;
            document.getElementById("priceField").value = "¬£" + price;
        }
    });
}

function select(index) {
    selectedService = services[index];
    render();
}

function getLocation() {
    navigator.geolocation.getCurrentPosition(p => {
        document.getElementById("location").value = `https://www.google.com/maps?q=${p.coords.latitude},${p.coords.longitude}`;
    });
}

document.getElementById("bookingForm").onsubmit = function(e) {
    e.preventDefault();
    if(!selectedService) return alert("Please select a service card first!");
    document.getElementById("summaryText").innerText = `${selectedService.name} - ${document.getElementById("priceField").value}`;
    document.getElementById("choiceModal").style.display = "flex";
};

function handleBooking(type) {
    const name = document.getElementById("userName").value;
    const vehicle = document.getElementById("userVehicle").value;
    const svc = document.getElementById("serviceField").value;
    const price = document.getElementById("priceField").value;
    const date = dateInput.value;
    const time = timeSelect.value + ":00";
    const loc = document.getElementById("location").value || "No GPS provided";

    const msg = `Hi SOS Mechanics! %0A%0A*New Booking Request*%0A*Name:* ${name}%0A*Vehicle:* ${vehicle}%0A*Service:* ${svc}%0A*Price:* ${price}%0A*Date:* ${date} at ${time}%0A*Location:* ${loc}`;

    if(type === 'whatsapp') {
        window.open(`https://wa.me/${myNumber}?text=${msg}`, '_blank');
        document.getElementById("choiceModal").style.display = "none";
    } else {
        document.getElementById("bookingForm").submit();
    }
}

dateInput.onchange = timeSelect.onchange = render;
render();
</script>

</body>
</html>