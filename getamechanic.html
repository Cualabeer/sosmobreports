<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SOS Mechanics | Mobile Diagnostics & Labour-Only Repairs Medway</title>
    
    <!-- Aggressive SEO: Two-Stage Model -->
    <meta name="description" content="Medway's Mobile Diagnostic Specialist. ¬£50 Initial Diag Call-out. Fixed Labour-only prices for repairs. We find the fault, you provide parts, we fit them at your door.">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <style>
        :root { --primary: #7a00ff; --whatsapp: #25D366; --bg: #f6f7fb; --white: #ffffff; --warn: #ff9800; }
        * { box-sizing: border-box; }
        body { font-family: system-ui, -apple-system, sans-serif; background: var(--bg); margin: 0; padding: 0; color: #111; }
        
        .top-bar { background: #111; color: white; text-align: center; padding: 10px; font-size: 12px; font-weight: bold; }

        .container { max-width: 900px; margin: auto; padding: 20px; }
        h1 { text-align: center; font-size: 26px; color: var(--primary); margin: 10px 0; }
        .subtext { text-align: center; color: #555; margin-bottom: 20px; font-size: 14px; }

        /* The Process Explained (SEO & Trust) */
        .process {
            display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 25px;
        }
        .step { background: #fff; padding: 15px; border-radius: 12px; border: 1px solid #ddd; font-size: 13px; }
        .step i { color: var(--primary); font-size: 20px; margin-bottom: 5px; }

        .cards { display: flex; gap: 16px; overflow-x: auto; padding: 10px 5px 25px; scroll-snap-type: x mandatory; scrollbar-width: none; }
        .cards::-webkit-scrollbar { display: none; }
        .card {
            min-width: 260px; background: var(--white); border-radius: 20px; padding: 20px;
            scroll-snap-align: center; box-shadow: 0 4px 15px rgba(0,0,0,.06);
            border: 2px solid transparent; text-align: center; transition: 0.3s;
        }
        .card.selected { border-color: var(--primary); background: #f4eeff; }
        .price { font-size: 30px; font-weight: 800; color: var(--primary); margin: 5px 0; }
        .tag { font-size: 10px; font-weight: bold; padding: 3px 8px; border-radius: 10px; background: #eee; display: inline-block; margin-bottom: 5px; }

        form { background: var(--white); padding: 25px; border-radius: 20px; box-shadow: 0 4px 15px rgba(0,0,0,.05); }
        input, select, button { width: 100%; padding: 14px; margin-top: 12px; border-radius: 12px; border: 1px solid #ddd; font-size: 16px; }
        button { background: var(--primary); color: var(--white); border: none; font-weight: 700; cursor: pointer; }
        
        #choiceModal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,.8); z-index: 2000; align-items: center; justify-content: center; padding: 20px; }
        .choice-box { background: white; padding: 30px; width: 100%; max-width: 400px; border-radius: 24px; text-align: center; }
        .wa-btn { background: var(--whatsapp); margin-bottom: 12px; display: flex; align-items: center; justify-content: center; gap: 10px; }
    </style>
</head>
<body>

<div class="top-bar">
    üõ†Ô∏è MEDWAY'S MOBILE MECHANIC: DIAGNOSTICS & LABOUR ONLY
</div>

<div class="container">
    <h1>SOS Mechanics</h1>
    <p class="subtext">Specializing in on-site Diagnostics & Fixed-Price Repairs.</p>

    <div class="process">
        <div class="step">
            <i class="fas fa-search"></i><br>
            <strong>Phase 1: Diag</strong><br>
            ¬£50 Call-out to visit and identify the fault.
        </div>
        <div class="step">
            <i class="fas fa-tools"></i><br>
            <strong>Phase 2: Repair</strong><br>
            Fixed Labour prices below (Second visit required).
        </div>
    </div>

    <h2>Select Service</h2>
    <div class="cards" id="services"></div>

    <form id="bookingForm" action="https://formspree.io/f/xaqdykza" method="POST">
        <h2 style="font-size: 18px; margin-top: 20px;">Booking Details</h2>
        <div style="display: flex; gap: 10px;">
            <input id="date" type="date">
            <select id="time"></select>
        </div>

        <input type="hidden" name="Service" id="serviceField">
        <input type="hidden" name="Labour_Price" id="priceField">
        
        <input required id="userName" name="Name" placeholder="Your Name">
        <input required id="userPhone" name="Phone" type="tel" placeholder="Mobile Number">
        <input required id="userVehicle" name="Vehicle" placeholder="Vehicle Reg / Model">
        <input id="location" name="Location" placeholder="GPS Link (Optional)" readonly>
        <button type="button" onclick="getLocation()" style="background:#eee; color:#333; font-size:12px;">üìç Tap to Share GPS</button>

        <button type="submit" style="margin-top: 20px; font-size: 18px;">Request Slot</button>
    </form>
</div>

<div id="choiceModal">
    <div class="choice-box">
        <h3 id="modalTitle">Initial Diag Visit</h3>
        <p id="summaryText" style="font-weight: bold; color: var(--primary); font-size: 24px;"></p>
        <p id="partsNote" style="font-size: 12px; color: #777; margin-top: -10px;"></p>
        
        <button class="wa-btn" onclick="handleBooking('whatsapp')"><i class="fab fa-whatsapp"></i> Book via WhatsApp</button>
        <button style="background: #333;" onclick="handleBooking('form')">Email Request</button>
    </div>
</div>

<script>
const myNumber = "447405937104";

// The 'hrs' here represents the fixed labour cost (hrs * 50)
const services = [
    { name: "Initial Diag & Call-out", hrs: 1, type: "DIAG", note: "Standard Inspection" },
    { name: "Front Brake Pads", hrs: 1.5, type: "FIX", note: "Repair Labour Only" },
    { name: "Rear Brake Pads", hrs: 1.5, type: "FIX", note: "Repair Labour Only" },
    { name: "Alternator Fitment", hrs: 2.5, type: "FIX", note: "Repair Labour Only" },
    { name: "Starter Motor Fitment", hrs: 2.0, type: "FIX", note: "Repair Labour Only" },
    { name: "Full Service", hrs: 2.5, type: "FIX", note: "Labour Only" },
    { name: "Battery Fitting", hrs: 1.0, type: "FIX", note: "Repair Labour Only" },
    { name: "Brake Discs & Pads", hrs: 3.0, type: "FIX", note: "Repair Labour Only" },
    { name: "Suspension Spring", hrs: 2.0, type: "FIX", note: "Repair Labour Only" },
    { name: "Other Repair", hrs: 1.5, type: "FIX", note: "Labour Quote" }
];

let selectedService = null;
const dateInput = document.getElementById("date");
const timeSelect = document.getElementById("time");

dateInput.min = new Date().toISOString().split("T")[0];
dateInput.value = dateInput.min;

for(let h=8; h<=20; h++) {
    let opt = document.createElement("option");
    opt.value = h; opt.text = h + ":00";
    timeSelect.appendChild(opt);
}

function calcPrice(s) {
    // If it's just a DIAG, it's just the 50 Callout. 
    // If it's a FIX, it's the Labour price (no callout in this view to avoid confusion, 
    // you will charge that separately as per your model).
    let price = s.hrs * 50;
    
    const d = new Date(dateInput.value);
    if(d.getDay() === 0 || d.getDay() === 6) price *= 1.2;
    
    return price.toFixed(2);
}

function render() {
    const container = document.getElementById("services");
    container.innerHTML = "";
    services.forEach((s, index) => {
        const price = calcPrice(s);
        const card = document.createElement("div");
        card.className = `card ${selectedService?.name === s.name ? 'selected' : ''}`;
        card.innerHTML = `
            <div class="tag">${s.type === 'DIAG' ? 'PHASE 1' : 'PHASE 2: REPAIR'}</div>
            <h3>${s.name}</h3>
            <div class="price">¬£${price}</div>
            <div style="font-size:12px; color:#666;">${s.note}</div>
            <button type="button" onclick="select(${index})" style="margin-top:10px;">Select</button>
        `;
        container.appendChild(card);
        if(selectedService?.name === s.name) {
            document.getElementById("serviceField").value = s.name;
            document.getElementById("priceField").value = "¬£" + price;
        }
    });
}

function select(index) { selectedService = services[index]; render(); }

function getLocation() {
    navigator.geolocation.getCurrentPosition(p => {
        document.getElementById("location").value = `https://www.google.com/maps?q=${p.coords.latitude},${p.coords.longitude}`;
    });
}

document.getElementById("bookingForm").onsubmit = function(e) {
    e.preventDefault();
    if(!selectedService) return alert("Please select a service card.");
    
    const isDiag = selectedService.type === 'DIAG';
    document.getElementById("modalTitle").innerText = isDiag ? "Diagnostic Visit Request" : "Repair Labour Booking";
    document.getElementById("summaryText").innerText = `¬£${calcPrice(selectedService)}`;
    document.getElementById("partsNote").innerText = isDiag ? "Covers call-out and inspection." : "Labour only. You provide the parts.";
    
    document.getElementById("choiceModal").style.display = "flex";
};

function handleBooking(type) {
    const name = document.getElementById("userName").value;
    const vehicle = document.getElementById("userVehicle").value;
    const svc = document.getElementById("serviceField").value;
    const price = document.getElementById("priceField").value;
    const date = dateInput.value;
    const time = timeSelect.value + ":00";
    const note = (selectedService.type === 'DIAG') ? "Diag/Inspection Visit" : "Repair Visit (Labour Only)";

    const msg = `Hi SOS Mechanics!%0A%0A*${note}*%0A*Service:* ${svc}%0A*Labour Quote:* ${price}%0A*Customer:* ${name}%0A*Vehicle:* ${vehicle}%0A*Date:* ${date} at ${time}`;

    if(type === 'whatsapp') {
        window.open(`https://wa.me/${myNumber}?text=${msg}`, '_blank');
    } else {
        document.getElementById("bookingForm").submit();
    }
}

dateInput.onchange = timeSelect.onchange = render;
render();
</script>

</body>
</html>