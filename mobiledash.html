<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mechanic Dashboard</title>
<link rel="stylesheet" href="style.css">
<style>
body { margin:0; font-family:sans-serif; background:#111; color:#eee; }
header { position:fixed; top:0; width:100%; background:#222; padding:10px; z-index:1000; }
#ticker { font-weight:bold; }
#job-list { margin-top:60px; max-height:50vh; overflow-y:auto; padding:10px; }
.job-card { position:relative; background:#1a1a1a; margin:10px 0; padding:15px 15px 15px 25px; border-radius:12px; box-shadow:0 0 5px #555; transition: transform 0.2s, box-shadow 0.2s; }
.job-card:hover { transform:scale(1.02); box-shadow:0 0 8px #888; }
.job-type-indicator { width:8px; height:100%; position:absolute; left:0; top:0; border-radius:6px 0 0 6px; }
.job-card[data-priority="emergency"] .job-type-indicator { background:#ff4d4d; }
.job-card[data-priority="same-day"] .job-type-indicator { background:#ffa500; }
.job-card[data-priority="normal"] .job-type-indicator { background:#0f0; }
.start-job-btn { margin-top:10px; width:100%; padding:10px; font-weight:bold; border:none; border-radius:8px; background:#8e2eff; color:white; cursor:pointer; transition: background 0.2s; }
.start-job-btn:hover { background:#6a1bd9; }

#checks-modal { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.95); z-index:2000; flex-direction:column; overflow-y:auto; padding:20px; }
#checks-modal h2 { text-align:center; margin-bottom:10px; }
#close-checks { background:#ff4d4d; color:white; border:none; border-radius:8px; padding:10px; width:100%; font-weight:bold; cursor:pointer; margin-top:10px; }
#job-timer { font-size:1.2rem; font-weight:bold; text-align:center; margin:10px 0; }
#map { width:100%; height:200px; margin-top:10px; border-radius:12px; background:#222; }

footer { position:fixed; bottom:0; width:100%; background:#222; padding:10px; display:flex; justify-content:space-around; z-index:1000; }
footer button { padding:10px; border:none; border-radius:8px; background:#444; color:white; font-weight:bold; cursor:pointer; }
</style>
</head>
<body>

<header>
  <div id="ticker">Live Jobs Ticker: Emergency at Tesco Extra, AB12 CDE | Same-day AJ62 KSV</div>
  <div id="job-timer">00:00:00</div>
</header>

<div id="job-list">
  <!-- Example jobs -->
  <div class="job-card" data-priority="emergency" data-name="John Doe" data-reg="AB12 CDE" data-location="Tesco Extra, Snodland" data-issue="Car won't start" data-emergency="Yes">
    <div class="job-type-indicator"></div>
    <div class="job-title">AB12 CDE</div>
    <div class="job-location">Tesco Extra, Snodland</div>
    <button class="start-job-btn">Start Job</button>
  </div>
  <div class="job-card" data-priority="same-day" data-name="Alice Smith" data-reg="AJ62 KSV" data-location="Morrisons, Rochester" data-issue="Flat tire" data-emergency="No">
    <div class="job-type-indicator"></div>
    <div class="job-title">AJ62 KSV</div>
    <div class="job-location">Morrisons, Rochester</div>
    <button class="start-job-btn">Start Job</button>
  </div>
  <div class="job-card" data-priority="normal" data-name="Bob Brown" data-reg="AC34 XYZ" data-location="High Street, Chatham" data-issue="Oil change" data-emergency="No">
    <div class="job-type-indicator"></div>
    <div class="job-title">AC34 XYZ</div>
    <div class="job-location">High Street, Chatham</div>
    <button class="start-job-btn">Start Job</button>
  </div>
  <!-- Add 4 more jobs as needed -->
</div>

<div id="map">Map Placeholder</div>

<!-- Essential Checks Modal -->
<div id="checks-modal" class="modal">
  <h2>Essential Checks</h2>
  <div><strong>Name:</strong> <span id="cust-name"></span></div>
  <div><strong>Reg:</strong> <span id="cust-reg"></span></div>
  <div><strong>Location:</strong> <span id="cust-location"></span></div>
  <div><strong>Issue:</strong> <span id="cust-issue"></span></div>
  <div><strong>Emergency:</strong> <span id="cust-emergency"></span></div>
  <!-- Add your checklist items here -->
  <button id="close-checks">Close</button>
</div>

<footer>
  <button>Dashboard</button>
  <button>QR Scan</button>
  <button>Settings</button>
</footer>

<script>
// --- Job Sorting ---
function sortJobs() {
    const jobList = document.getElementById("job-list");
    const jobs = Array.from(jobList.children);
    jobs.sort((a,b)=>{
        const priorityOrder = { "emergency":0, "same-day":1, "normal":2 };
        return priorityOrder[a.dataset.priority] - priorityOrder[b.dataset.priority];
    });
    jobs.forEach(job => jobList.appendChild(job));
}
sortJobs();

// --- Start Job Button ---
const checksModal = document.getElementById("checks-modal");
const jobTimerDisplay = document.getElementById("job-timer");

function startJobTimer() {
    let seconds = 0;
    jobTimerDisplay.style.color = "#0f0";
    const interval = setInterval(() => {
        seconds++;
        const h = String(Math.floor(seconds/3600)).padStart(2,'0');
        const m = String(Math.floor((seconds%3600)/60)).padStart(2,'0');
        const s = String(seconds%60).padStart(2,'0');
        jobTimerDisplay.textContent = `${h}:${m}:${s}`;
        if(seconds >= 3600) jobTimerDisplay.style.color = "red";
    }, 1000);
    return interval;
}

document.querySelectorAll(".start-job-btn").forEach(btn=>{
    btn.addEventListener("click", ()=>{
        const card = btn.closest(".job-card");
        document.getElementById("cust-name").textContent = card.dataset.name;
        document.getElementById("cust-reg").textContent = card.dataset.reg;
        document.getElementById("cust-location").textContent = card.dataset.location;
        document.getElementById("cust-issue").textContent = card.dataset.issue;
        document.getElementById("cust-emergency").textContent = card.dataset.emergency;

        checksModal.style.display = "flex";

        if(window.jobTimerInterval) clearInterval(window.jobTimerInterval);
        window.jobTimerInterval = startJobTimer();
    });
});

document.getElementById("close-checks").onclick = ()=>{
    checksModal.style.display = "none";
};
</script>
</body>
</html>